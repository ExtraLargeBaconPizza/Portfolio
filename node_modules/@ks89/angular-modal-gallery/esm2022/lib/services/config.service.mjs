/*
 The MIT License (MIT)

 Copyright (C) 2017-2023 Stefano Cappa (Ks89)

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in all
 copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NON INFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 SOFTWARE.
 */
import { Injectable } from '@angular/core';
import { KS_DEFAULT_ACCESSIBILITY_CONFIG } from '../components/accessibility-default';
import { ButtonsStrategy } from '../model/buttons-config.interface';
import { GridLayout, LineLayout, PlainGalleryStrategy } from '../model/plain-gallery-config.interface';
import { LoadingType } from '../model/loading-config.interface';
import { DescriptionStrategy } from '../model/description.interface';
import * as i0 from "@angular/core";
export const DEFAULT_PREVIEW_SIZE = { height: '50px', width: 'auto' };
export const DEFAULT_LAYOUT = new LineLayout(DEFAULT_PREVIEW_SIZE, { length: -1, wrap: false }, 'flex-start');
export const DEFAULT_PLAIN_CONFIG = {
    strategy: PlainGalleryStrategy.ROW,
    layout: DEFAULT_LAYOUT,
    advanced: { aTags: false, additionalBackground: '50% 50%/cover' }
};
export const DEFAULT_LOADING = { enable: true, type: LoadingType.STANDARD };
export const DEFAULT_DESCRIPTION_STYLE = {
    bgColor: 'rgba(0, 0, 0, .5)',
    textColor: 'white',
    marginTop: '0px',
    marginBottom: '0px',
    marginLeft: '0px',
    marginRight: '0px'
};
export const DEFAULT_DESCRIPTION = {
    strategy: DescriptionStrategy.ALWAYS_VISIBLE,
    imageText: 'Image ',
    numberSeparator: '/',
    beforeTextDescription: ' - ',
    style: DEFAULT_DESCRIPTION_STYLE
};
export const DEFAULT_CAROUSEL_DESCRIPTION = {
    strategy: DescriptionStrategy.ALWAYS_HIDDEN,
    imageText: 'Image ',
    numberSeparator: '/',
    beforeTextDescription: ' - ',
    style: DEFAULT_DESCRIPTION_STYLE
};
export const DEFAULT_CURRENT_IMAGE_CONFIG = {
    navigateOnClick: true,
    loadingConfig: DEFAULT_LOADING,
    description: DEFAULT_DESCRIPTION,
    downloadable: false,
    invertSwipe: false
};
export const DEFAULT_CAROUSEL_IMAGE_CONFIG = {
    description: DEFAULT_CAROUSEL_DESCRIPTION,
    invertSwipe: false
};
export const DEFAULT_CURRENT_CAROUSEL_CONFIG = {
    maxWidth: '100%',
    maxHeight: '400px',
    showArrows: true,
    objectFit: 'cover',
    keyboardEnable: true,
    modalGalleryEnable: false
};
export const DEFAULT_CURRENT_CAROUSEL_PLAY = {
    autoPlay: true,
    interval: 5000,
    pauseOnHover: true
};
export const DEFAULT_CAROUSEL_BREAKPOINTS = { xSmall: 100, small: 100, medium: 150, large: 200, xLarge: 200 };
export const DEFAULT_CAROUSEL_PREVIEWS_CONFIG = {
    visible: true,
    number: 4,
    arrows: true,
    clickable: true,
    width: 100 / 4 + '%',
    maxHeight: '200px',
    breakpoints: DEFAULT_CAROUSEL_BREAKPOINTS
};
export const DEFAULT_SLIDE_CONFIG = {
    infinite: false,
    playConfig: { autoPlay: false, interval: 5000, pauseOnHover: true },
    sidePreviews: { show: true, size: { width: '100px', height: 'auto' } }
};
export const DEFAULT_PREVIEW_CONFIG = {
    visible: true,
    number: 3,
    arrows: true,
    clickable: true,
    size: DEFAULT_PREVIEW_SIZE
};
const DEFAULT_CONFIG = Object.freeze({
    slideConfig: DEFAULT_SLIDE_CONFIG,
    accessibilityConfig: KS_DEFAULT_ACCESSIBILITY_CONFIG,
    previewConfig: DEFAULT_PREVIEW_CONFIG,
    buttonsConfig: { visible: true, strategy: ButtonsStrategy.DEFAULT },
    dotsConfig: { visible: true },
    plainGalleryConfig: DEFAULT_PLAIN_CONFIG,
    currentImageConfig: DEFAULT_CURRENT_IMAGE_CONFIG,
    keyboardConfig: undefined,
    carouselConfig: DEFAULT_CURRENT_CAROUSEL_CONFIG,
    carouselImageConfig: DEFAULT_CAROUSEL_IMAGE_CONFIG,
    carouselPreviewsConfig: DEFAULT_CAROUSEL_PREVIEWS_CONFIG,
    carouselPlayConfig: DEFAULT_CURRENT_CAROUSEL_PLAY,
    carouselDotsConfig: { visible: true },
    carouselSlideInfinite: true,
    enableCloseOutside: true
});
/**
 * Service to handle library configuration in a unique place
 */
class ConfigService {
    constructor() {
        this.configMap = new Map();
    }
    getConfig(id) {
        this.initIfNotExists(id);
        return this.configMap.get(id);
    }
    setConfig(id, obj) {
        this.initIfNotExists(id);
        if (!obj) {
            return;
        }
        if (!DEFAULT_CONFIG ||
            !DEFAULT_CONFIG.slideConfig ||
            !DEFAULT_CONFIG.slideConfig.sidePreviews ||
            !DEFAULT_CONFIG.previewConfig ||
            !DEFAULT_CONFIG.previewConfig.size ||
            !DEFAULT_CONFIG.previewConfig.number ||
            !DEFAULT_CONFIG.plainGalleryConfig ||
            !DEFAULT_CONFIG.currentImageConfig ||
            !DEFAULT_CONFIG.currentImageConfig ||
            !DEFAULT_CONFIG.currentImageConfig.description ||
            !DEFAULT_CONFIG.carouselImageConfig ||
            !DEFAULT_CONFIG.carouselImageConfig.description ||
            !DEFAULT_CONFIG.carouselPreviewsConfig ||
            !DEFAULT_CONFIG.carouselPreviewsConfig.breakpoints ||
            !DEFAULT_CAROUSEL_PREVIEWS_CONFIG.number) {
            throw new Error('Internal library error - DEFAULT_CONFIG must be fully initialized!!!');
        }
        const newConfig = Object.assign({}, this.configMap.get(id));
        if (obj.slideConfig) {
            let playConfig;
            let sidePreviews;
            let size;
            if (obj.slideConfig.playConfig) {
                playConfig = Object.assign({}, DEFAULT_CONFIG.slideConfig.playConfig, obj.slideConfig.playConfig);
            }
            else {
                playConfig = DEFAULT_CONFIG.slideConfig.playConfig;
            }
            if (obj.slideConfig.sidePreviews) {
                if (obj.slideConfig.sidePreviews.size) {
                    size = Object.assign({}, DEFAULT_CONFIG.slideConfig.sidePreviews.size, obj.slideConfig.sidePreviews.size);
                }
                else {
                    size = DEFAULT_CONFIG.slideConfig.sidePreviews.size;
                }
                sidePreviews = Object.assign({}, DEFAULT_CONFIG.slideConfig.sidePreviews, obj.slideConfig.sidePreviews);
            }
            else {
                sidePreviews = DEFAULT_CONFIG.slideConfig.sidePreviews;
                size = DEFAULT_CONFIG.slideConfig.sidePreviews.size;
            }
            const newSlideConfig = Object.assign({}, DEFAULT_CONFIG.slideConfig, obj.slideConfig);
            newSlideConfig.playConfig = playConfig;
            newSlideConfig.sidePreviews = sidePreviews;
            newSlideConfig.sidePreviews.size = size;
            newConfig.slideConfig = newSlideConfig;
        }
        if (obj.accessibilityConfig) {
            newConfig.accessibilityConfig = Object.assign({}, DEFAULT_CONFIG.accessibilityConfig, obj.accessibilityConfig);
        }
        if (obj.previewConfig) {
            let size;
            let num;
            if (obj.previewConfig.size) {
                size = Object.assign({}, DEFAULT_CONFIG.previewConfig.size, obj.previewConfig.size);
            }
            else {
                size = DEFAULT_CONFIG.previewConfig.size;
            }
            if (obj.previewConfig.number) {
                if (obj.previewConfig.number <= 0) {
                    // if number is <= 0 reset to default
                    num = DEFAULT_CONFIG.previewConfig.number;
                }
                else {
                    num = obj.previewConfig.number;
                }
            }
            else {
                num = DEFAULT_CONFIG.previewConfig.number;
            }
            const newPreviewConfig = Object.assign({}, DEFAULT_CONFIG.previewConfig, obj.previewConfig);
            newPreviewConfig.size = size;
            newPreviewConfig.number = num;
            newConfig.previewConfig = newPreviewConfig;
        }
        if (obj.buttonsConfig) {
            newConfig.buttonsConfig = Object.assign({}, DEFAULT_CONFIG.buttonsConfig, obj.buttonsConfig);
        }
        if (obj.dotsConfig) {
            newConfig.dotsConfig = Object.assign({}, DEFAULT_CONFIG.dotsConfig, obj.dotsConfig);
        }
        if (obj.plainGalleryConfig) {
            let advanced;
            let layout;
            if (obj.plainGalleryConfig.advanced) {
                advanced = Object.assign({}, DEFAULT_CONFIG.plainGalleryConfig.advanced, obj.plainGalleryConfig.advanced);
            }
            else {
                advanced = DEFAULT_CONFIG.plainGalleryConfig.advanced;
            }
            if (obj.plainGalleryConfig.layout) {
                // it isn't mandatory to use assign, because obj.plainGalleryConfig.layout is an instance of class (LineaLayout, GridLayout)
                layout = obj.plainGalleryConfig.layout;
            }
            else {
                layout = DEFAULT_CONFIG.plainGalleryConfig.layout;
            }
            const newPlainGalleryConfig = Object.assign({}, DEFAULT_CONFIG.plainGalleryConfig, obj.plainGalleryConfig);
            newPlainGalleryConfig.layout = layout;
            newPlainGalleryConfig.advanced = advanced;
            newConfig.plainGalleryConfig = initPlainGalleryConfig(newPlainGalleryConfig);
        }
        if (obj.currentImageConfig) {
            let loading;
            let description;
            let descriptionStyle;
            if (obj.currentImageConfig.loadingConfig) {
                loading = Object.assign({}, DEFAULT_CONFIG.currentImageConfig.loadingConfig, obj.currentImageConfig.loadingConfig);
            }
            else {
                loading = DEFAULT_CONFIG.currentImageConfig.loadingConfig;
            }
            if (obj.currentImageConfig.description) {
                description = Object.assign({}, DEFAULT_CONFIG.currentImageConfig.description, obj.currentImageConfig.description);
                if (obj.currentImageConfig.description.style) {
                    descriptionStyle = Object.assign({}, DEFAULT_CONFIG.currentImageConfig.description.style, obj.currentImageConfig.description.style);
                }
                else {
                    descriptionStyle = DEFAULT_CONFIG.currentImageConfig.description.style;
                }
            }
            else {
                description = DEFAULT_CONFIG.currentImageConfig.description;
                descriptionStyle = DEFAULT_CONFIG.currentImageConfig.description.style;
            }
            const newCurrentImageConfig = Object.assign({}, DEFAULT_CONFIG.currentImageConfig, obj.currentImageConfig);
            newCurrentImageConfig.loadingConfig = loading;
            newCurrentImageConfig.description = description;
            newCurrentImageConfig.description.style = descriptionStyle;
            newConfig.currentImageConfig = newCurrentImageConfig;
        }
        if (obj.keyboardConfig) {
            newConfig.keyboardConfig = Object.assign({}, DEFAULT_CONFIG.keyboardConfig, obj.keyboardConfig);
        }
        // carousel
        if (obj.carouselConfig) {
            newConfig.carouselConfig = Object.assign({}, DEFAULT_CONFIG.carouselConfig, obj.carouselConfig);
        }
        if (obj.carouselImageConfig) {
            let description;
            let descriptionStyle;
            if (obj.carouselImageConfig.description) {
                description = Object.assign({}, DEFAULT_CONFIG.carouselImageConfig.description, obj.carouselImageConfig.description);
                if (obj.carouselImageConfig.description.style) {
                    descriptionStyle = Object.assign({}, DEFAULT_CONFIG.carouselImageConfig.description.style, obj.carouselImageConfig.description.style);
                }
                else {
                    descriptionStyle = DEFAULT_CONFIG.carouselImageConfig.description.style;
                }
            }
            else {
                description = DEFAULT_CONFIG.carouselImageConfig.description;
                descriptionStyle = DEFAULT_CONFIG.carouselImageConfig.description.style;
            }
            const newCarouselImageConfig = Object.assign({}, DEFAULT_CONFIG.carouselImageConfig, obj.carouselImageConfig);
            newCarouselImageConfig.description = description;
            newCarouselImageConfig.description.style = descriptionStyle;
            newConfig.carouselImageConfig = newCarouselImageConfig;
        }
        if (obj.carouselPlayConfig) {
            // check values
            if (obj.carouselPlayConfig.interval <= 0) {
                throw new Error(`Carousel's interval must be a number >= 0`);
            }
            newConfig.carouselPlayConfig = Object.assign({}, DEFAULT_CONFIG.carouselPlayConfig, obj.carouselPlayConfig);
        }
        if (obj.carouselPreviewsConfig) {
            // check values
            let num;
            let breakpoints;
            if (!obj.carouselPreviewsConfig.number || obj.carouselPreviewsConfig.number <= 0) {
                num = DEFAULT_CAROUSEL_PREVIEWS_CONFIG.number;
            }
            else {
                num = obj.carouselPreviewsConfig.number;
            }
            if (obj.carouselPreviewsConfig.breakpoints) {
                breakpoints = Object.assign({}, DEFAULT_CONFIG.carouselPreviewsConfig.breakpoints, obj.carouselPreviewsConfig.breakpoints);
            }
            else {
                breakpoints = DEFAULT_CONFIG.carouselPreviewsConfig.breakpoints;
            }
            newConfig.carouselPreviewsConfig = Object.assign({}, DEFAULT_CONFIG.carouselPreviewsConfig, obj.carouselPreviewsConfig);
            newConfig.carouselPreviewsConfig.number = num;
            newConfig.carouselPreviewsConfig.breakpoints = breakpoints;
            // Init preview image width based on the number of previews in PreviewConfig
            // Don't move this line above, because I need to be sure that both configPreview.number
            // and configPreview.size are initialized
            newConfig.carouselPreviewsConfig.width = 100 / newConfig.carouselPreviewsConfig.number + '%';
        }
        if (obj.carouselDotsConfig) {
            newConfig.carouselDotsConfig = Object.assign({}, DEFAULT_CONFIG.carouselDotsConfig, obj.carouselDotsConfig);
        }
        if (obj.carouselSlideInfinite === undefined) {
            newConfig.carouselSlideInfinite = DEFAULT_CONFIG.carouselSlideInfinite;
        }
        else {
            newConfig.carouselSlideInfinite = obj.carouselSlideInfinite;
        }
        if (obj.enableCloseOutside === undefined) {
            newConfig.enableCloseOutside = DEFAULT_CONFIG.enableCloseOutside;
        }
        else {
            newConfig.enableCloseOutside = obj.enableCloseOutside;
        }
        this.configMap.set(id, newConfig);
    }
    initIfNotExists(id) {
        if (!this.configMap.has(id)) {
            this.configMap.set(id, DEFAULT_CONFIG);
        }
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.0.0", ngImport: i0, type: ConfigService, deps: [], target: i0.ɵɵFactoryTarget.Injectable }); }
    static { this.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: "12.0.0", version: "16.0.0", ngImport: i0, type: ConfigService, providedIn: 'root' }); }
}
export { ConfigService };
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.0.0", ngImport: i0, type: ConfigService, decorators: [{
            type: Injectable,
            args: [{ providedIn: 'root' }]
        }] });
/**
 * Function to build and return a `PlainGalleryConfig` object, proving also default values and validating the input object.
 * @param plainGalleryConfig object with the config requested by user
 * @returns PlainGalleryConfig the plain gallery configuration
 * @throws an Error if layout and strategy aren't compatible
 */
function initPlainGalleryConfig(plainGalleryConfig) {
    const newPlayGalleryConfig = Object.assign({}, DEFAULT_CONFIG.plainGalleryConfig, plainGalleryConfig);
    if (newPlayGalleryConfig.layout instanceof LineLayout) {
        if (newPlayGalleryConfig.strategy !== PlainGalleryStrategy.ROW && newPlayGalleryConfig.strategy !== PlainGalleryStrategy.COLUMN) {
            throw new Error('LineLayout requires either ROW or COLUMN strategy');
        }
        if (!newPlayGalleryConfig.layout || !newPlayGalleryConfig.layout.breakConfig) {
            throw new Error('Both layout and breakConfig must be valid');
        }
    }
    if (newPlayGalleryConfig.layout instanceof GridLayout) {
        if (newPlayGalleryConfig.strategy !== PlainGalleryStrategy.GRID) {
            throw new Error('GridLayout requires GRID strategy');
        }
        if (!newPlayGalleryConfig.layout || !newPlayGalleryConfig.layout.breakConfig) {
            throw new Error('Both layout and breakConfig must be valid');
        }
        // force wrap for grid layout
        newPlayGalleryConfig.layout.breakConfig.wrap = true;
    }
    return newPlayGalleryConfig;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29uZmlnLnNlcnZpY2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9rczg5L2FuZ3VsYXItbW9kYWwtZ2FsbGVyeS9zcmMvbGliL3NlcnZpY2VzL2NvbmZpZy5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0dBc0JHO0FBRUgsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUczQyxPQUFPLEVBQUUsK0JBQStCLEVBQUUsTUFBTSxxQ0FBcUMsQ0FBQztBQUd0RixPQUFPLEVBQWlCLGVBQWUsRUFBRSxNQUFNLG1DQUFtQyxDQUFDO0FBRW5GLE9BQU8sRUFBRSxVQUFVLEVBQUUsVUFBVSxFQUFzQixvQkFBb0IsRUFBRSxNQUFNLHlDQUF5QyxDQUFDO0FBRTNILE9BQU8sRUFBaUIsV0FBVyxFQUFFLE1BQU0sbUNBQW1DLENBQUM7QUFDL0UsT0FBTyxFQUFlLG1CQUFtQixFQUFvQixNQUFNLGdDQUFnQyxDQUFDOztBQU1wRyxNQUFNLENBQUMsTUFBTSxvQkFBb0IsR0FBUyxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxDQUFDO0FBQzVFLE1BQU0sQ0FBQyxNQUFNLGNBQWMsR0FBZSxJQUFJLFVBQVUsQ0FBQyxvQkFBb0IsRUFBRSxFQUFFLE1BQU0sRUFBRSxDQUFDLENBQUMsRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLEVBQUUsWUFBWSxDQUFDLENBQUM7QUFDMUgsTUFBTSxDQUFDLE1BQU0sb0JBQW9CLEdBQXVCO0lBQ3RELFFBQVEsRUFBRSxvQkFBb0IsQ0FBQyxHQUFHO0lBQ2xDLE1BQU0sRUFBRSxjQUFjO0lBQ3RCLFFBQVEsRUFBRSxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsb0JBQW9CLEVBQUUsZUFBZSxFQUFFO0NBQ2xFLENBQUM7QUFDRixNQUFNLENBQUMsTUFBTSxlQUFlLEdB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RCxJQUFJLENBQUMsb0JBQW9CLENBQUMsTUFBTSxJQUFJLENBQUMsb0JBQW9CLENBQUMsTUFBTSxDQUFDLFdBQVcsRUFBRTtZQUM1RSxNQUFNLElBQUksS0FBSyxDQUFDLDJDQUEyQyxDQUFDLENBQUM7U0FDOUQ7S0FDRjtJQUVELElBQUksb0JBQW9CLENBQUMsTUFBTSxZQUFZLFVBQVUsRUFBRTtRQUNyRCxJQUFJLG9CQUFvQixDQUFDLFFBQVEsS0FBSyxvQkFBb0IsQ0FBQyxJQUFJLEVBQUU7WUFDL0QsTUFBTSxJQUFJLEtBQUssQ0FBQyxtQ0FBbUMsQ0FBQyxDQUFDO1NBQ3REO1FBQ0QsSUFBSSxDQUFDLG9CQUFvQixDQUFDLE1BQU0sSUFBSSxDQUFDLG9CQUFvQixDQUFDLE1BQU0sQ0FBQyxXQUFXLEVBQUU7WUFDNUUsTUFBTSxJQUFJLEtBQUssQ0FBQywyQ0FBMkMsQ0FBQyxDQUFDO1NBQzlEO1FBQ0QsNkJBQTZCO1FBQzdCLG9CQUFvQixDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztLQUNyRDtJQUNELE9BQU8sb0JBQW9CLENBQUM7QUFDOUIsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gVGhlIE1JVCBMaWNlbnNlIChNSVQpXG5cbiBDb3B5cmlnaHQgKEMpIDIwMTctMjAyMyBTdGVmYW5vIENhcHBhIChLczg5KVxuXG4gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbiBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzXG4gdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG5cbiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbiBhbGxcbiBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuXG4gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUlxuIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLFxuIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT04gSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcbiBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG4gTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRVxuIFNPRlRXQVJFLlxuICovXG5cbmltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IFNpZGVQcmV2aWV3c0NvbmZpZywgU2xpZGVDb25maWcgfSBmcm9tICcuLi9tb2RlbC9zbGlkZS1jb25maWcuaW50ZXJmYWNlJztcbmltcG9ydCB7IFBsYXlDb25maWcgfSBmcm9tICcuLi9tb2RlbC9wbGF5LWNvbmZpZy5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgS1NfREVGQVVMVF9BQ0NFU1NJQklMSVRZX0NPTkZJRyB9IGZyb20gJy4uL2NvbXBvbmVudHMvYWNjZXNzaWJpbGl0eS1kZWZhdWx0JztcbmltcG9ydCB7IFByZXZpZXdDb25maWcgfSBmcm9tICcuLi9tb2RlbC9wcmV2aWV3LWNvbmZpZy5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgU2l6ZSB9IGZyb20gJy4uL21vZGVsL3NpemUuaW50ZXJmYWNlJztcbmltcG9ydCB7IEJ1dHRvbnNDb25maWcsIEJ1dHRvbnNTdHJhdGVneSB9IGZyb20gJy4uL21vZGVsL2J1dHRvbnMtY29uZmlnLmludGVyZmFjZSc7XG5pbXBvcnQgeyBEb3RzQ29uZmlnIH0gZnJvbSAnLi4vbW9kZWwvZG90cy1jb25maWcuaW50ZXJmYWNlJztcbmltcG9ydCB7IEdyaWRMYXlvdXQsIExpbmVMYXlvdXQsIFBsYWluR2FsbGVyeUNvbmZpZywgUGxhaW5HYWxsZXJ5U3RyYXRlZ3kgfSBmcm9tICcuLi9tb2RlbC9wbGFpbi1nYWxsZXJ5LWNvbmZpZy5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgQ3VycmVudEltYWdlQ29uZmlnIH0gZnJvbSAnLi4vbW9kZWwvY3VycmVudC1pbWFnZS1jb25maWcuaW50ZXJmYWNlJztcbmltcG9ydCB7IExvYWRpbmdDb25maWcsIExvYWRpbmdUeXBlIH0gZnJvbSAnLi4vbW9kZWwvbG9hZGluZy1jb25maWcuaW50ZXJmYWNlJztcbmltcG9ydCB7IERlc2NyaXB0aW9uLCBEZXNjcmlwdGlvblN0cmF0ZWd5LCBEZXNjcmlwdGlvblN0eWxlIH0gZnJvbSAnLi4vbW9kZWwvZGVzY3JpcHRpb24uaW50ZXJmYWNlJztcbmltcG9ydCB7IENhcm91c2VsQ29uZmlnIH0gZnJvbSAnLi4vbW9kZWwvY2Fyb3VzZWwtY29uZmlnLmludGVyZmFjZSc7XG5pbXBvcnQgeyBDYXJvdXNlbEltYWdlQ29uZmlnIH0gZnJvbSAnLi4vbW9kZWwvY2Fyb3VzZWwtaW1hZ2UtY29uZmlnLmludGVyZmFjZSc7XG5pbXBvcnQgeyBCcmVha3BvaW50c0NvbmZpZywgQ2Fyb3VzZWxQcmV2aWV3Q29uZmlnIH0gZnJvbSAnLi4vbW9kZWwvY2Fyb3VzZWwtcHJldmlldy1jb25maWcuaW50ZXJmYWNlJztcbmltcG9ydCB7IExpYkNvbmZpZyB9IGZyb20gJy4uL21vZGVsL2xpYi1jb25maWcuaW50ZXJmYWNlJztcblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfUFJFVklFV19TSVpFOiBTaXplID0geyBoZWlnaHQ6ICc1MHB4Jywgd2lkdGg6ICdhdXRvJyB9O1xuZXhwb3J0IGNvbnN0IERFRkFVTFRfTEFZT1VUOiBMaW5lTGF5b3V0ID0gbmV3IExpbmVMYXlvdXQoREVGQVVMVF9QUkVWSUVXX1NJWkUsIHsgbGVuZ3RoOiAtMSwgd3JhcDogZmFsc2UgfSwgJ2ZsZXgtc3RhcnQnKTtcbmV4cG9ydCBjb25zdCBERUZBVUxUX1BMQUlOX0NPTkZJRzogUGxhaW5HYWxsZXJ5Q29uZmlnID0ge1xuICBzdHJhdGVneTogUGxhaW5HYWxsZXJ5U3RyYXRlZ3kuUk9XLFxuICBsYXlvdXQ6IERFRkFVTFRfTEFZT1VULFxuICBhZHZhbmNlZDogeyBhVGFnczogZmFsc2UsIGFkZGl0aW9uYWxCYWNrZ3JvdW5kOiAnNTAlIDUwJS9jb3ZlcicgfVxufTtcbmV4cG9ydCBjb25zdCBERUZBVUxUX0xPQURJTkc6IExvYWRpbmdDb25maWcgPSB7IGVuYWJsZTogdHJ1ZSwgdHlwZTogTG9hZGluZ1R5cGUuU1RBTkRBUkQgfTtcbmV4cG9ydCBjb25zdCBERUZBVUxUX0RFU0NSSVBUSU9OX1NUWUxFOiBEZXNjcmlwdGlvblN0eWxlID0ge1xuICBiZ0NvbG9yOiAncmdiYSgwLCAwLCAwLCAuNSknLFxuICB0ZXh0Q29sb3I6ICd3aGl0ZScsXG4gIG1hcmdpblRvcDogJzBweCcsXG4gIG1hcmdpbkJvdHRvbTogJzBweCcsXG4gIG1hcmdpbkxlZnQ6ICcwcHgnLFxuICBtYXJnaW5SaWdodDogJzBweCdcbn07XG5leHBvcnQgY29uc3QgREVGQVVMVF9ERVNDUklQVElPTjogRGVzY3JpcHRpb24gPSB7XG4gIHN0cmF0ZWd5OiBEZXNjcmlwdGlvblN0cmF0ZWd5LkFMV0FZU19WSVNJQkxFLFxuICBpbWFnZVRleHQ6ICdJbWFnZSAnLFxuICBudW1iZXJTZXBhcmF0b3I6ICcvJyxcbiAgYmVmb3JlVGV4dERlc2NyaXB0aW9uOiAnIC0gJyxcbiAgc3R5bGU6IERFRkFVTFRfREVTQ1JJUFRJT05fU1RZTEVcbn07XG5leHBvcnQgY29uc3QgREVGQVVMVF9DQVJPVVNFTF9ERVNDUklQVElPTjogRGVzY3JpcHRpb24gPSB7XG4gIHN0cmF0ZWd5OiBEZXNjcmlwdGlvblN0cmF0ZWd5LkFMV0FZU19ISURERU4sXG4gIGltYWdlVGV4dDogJ0ltYWdlICcsXG4gIG51bWJlclNlcGFyYXRvcjogJy8nLFxuICBiZWZvcmVUZXh0RGVzY3JpcHRpb246ICcgLSAnLFxuICBzdHlsZTogREVGQVVMVF9ERVNDUklQVElPTl9TVFlMRVxufTtcbmV4cG9ydCBjb25zdCBERUZBVUxUX0NVUlJFTlRfSU1BR0VfQ09ORklHOiBDdXJyZW50SW1hZ2VDb25maWcgPSB7XG4gIG5hdmlnYXRlT25DbGljazogdHJ1ZSxcbiAgbG9hZGluZ0NvbmZpZzogREVGQVVMVF9MT0FESU5HLFxuICBkZXNjcmlwdGlvbjogREVGQVVMVF9ERVNDUklQVElPTixcbiAgZG93bmxvYWRhYmxlOiBmYWxzZSxcbiAgaW52ZXJ0U3dpcGU6IGZhbHNlXG59O1xuZXhwb3J0IGNvbnN0IERFRkFVTFRfQ0FST1VTRUxfSU1BR0VfQ09ORklHOiBDYXJvdXNlbEltYWdlQ29uZmlnID0ge1xuICBkZXNjcmlwdGlvbjogREVGQVVMVF9DQVJPVVNFTF9ERVNDUklQVElPTixcbiAgaW52ZXJ0U3dpcGU6IGZhbHNlXG59O1xuZXhwb3J0IGNvbnN0IERFRkFVTFRfQ1VSUkVOVF9DQVJPVVNFTF9DT05GSUc6IENhcm91c2VsQ29uZmlnID0ge1xuICBtYXhXaWR0aDogJzEwMCUnLFxuICBtYXhIZWlnaHQ6ICc0MDBweCcsXG4gIHNob3dBcnJvd3M6IHRydWUsXG4gIG9iamVjdEZpdDogJ2NvdmVyJyxcbiAga2V5Ym9hcmRFbmFibGU6IHRydWUsXG4gIG1vZGFsR2FsbGVyeUVuYWJsZTogZmFsc2Vcbn07XG5leHBvcnQgY29uc3QgREVGQVVMVF9DVVJSRU5UX0NBUk9VU0VMX1BMQVk6IFBsYXlDb25maWcgPSB7XG4gIGF1dG9QbGF5OiB0cnVlLFxuICBpbnRlcnZhbDogNTAwMCxcbiAgcGF1c2VPbkhvdmVyOiB0cnVlXG59O1xuXG5leHBvcnQgY29uc3QgREVGQVVMVF9DQVJPVVNFTF9CUkVBS1BPSU5UUzogQnJlYWtwb2ludHNDb25maWcgPSB7IHhTbWFsbDogMTAwLCBzbWFsbDogMTAwLCBtZWRpdW06IDE1MCwgbGFyZ2U6IDIwMCwgeExhcmdlOiAyMDAgfTtcbmV4cG9ydCBjb25zdCBERUZBVUxUX0NBUk9VU0VMX1BSRVZJRVdTX0NPTkZJRzogQ2Fyb3VzZWxQcmV2aWV3Q29uZmlnID0ge1xuICB2aXNpYmxlOiB0cnVlLFxuICBudW1iZXI6IDQsXG4gIGFycm93czogdHJ1ZSxcbiAgY2xpY2thYmxlOiB0cnVlLFxuICB3aWR0aDogMTAwIC8gNCArICclJyxcbiAgbWF4SGVpZ2h0OiAnMjAwcHgnLFxuICBicmVha3BvaW50czogREVGQVVMVF9DQVJPVVNFTF9CUkVBS1BPSU5UU1xufTtcbmV4cG9ydCBjb25zdCBERUZBVUxUX1NMSURFX0NPTkZJRzogU2xpZGVDb25maWcgPSB7XG4gIGluZmluaXRlOiBmYWxzZSxcbiAgcGxheUNvbmZpZzogeyBhdXRvUGxheTogZmFsc2UsIGludGVydmFsOiA1MDAwLCBwYXVzZU9uSG92ZXI6IHRydWUgfSBhcyBQbGF5Q29uZmlnLFxuICBzaWRlUHJldmlld3M6IHsgc2hvdzogdHJ1ZSwgc2l6ZTogeyB3aWR0aDogJzEwMHB4JywgaGVpZ2h0OiAnYXV0bycgfSB9IGFzIFNpZGVQcmV2aWV3c0NvbmZpZ1xufTtcbmV4cG9ydCBjb25zdCBERUZBVUxUX1BSRVZJRVdfQ09ORklHOiBQcmV2aWV3Q29uZmlnID0ge1xuICB2aXNpYmxlOiB0cnVlLFxuICBudW1iZXI6IDMsXG4gIGFycm93czogdHJ1ZSxcbiAgY2xpY2thYmxlOiB0cnVlLFxuICBzaXplOiBERUZBVUxUX1BSRVZJRVdfU0laRVxufTtcblxuY29uc3QgREVGQVVMVF9DT05GSUc6IExpYkNvbmZpZyA9IE9iamVjdC5mcmVlemUoe1xuICBzbGlkZUNvbmZpZzogREVGQVVMVF9TTElERV9DT05GSUcsXG4gIGFjY2Vzc2liaWxpdHlDb25maWc6IEtTX0RFRkFVTFRfQUNDRVNTSUJJTElUWV9DT05GSUcsXG4gIHByZXZpZXdDb25maWc6IERFRkFVTFRfUFJFVklFV19DT05GSUcsXG4gIGJ1dHRvbnNDb25maWc6IHsgdmlzaWJsZTogdHJ1ZSwgc3RyYXRlZ3k6IEJ1dHRvbnNTdHJhdGVneS5ERUZBVUxUIH0gYXMgQnV0dG9uc0NvbmZpZyxcbiAgZG90c0NvbmZpZzogeyB2aXNpYmxlOiB0cnVlIH0gYXMgRG90c0NvbmZpZyxcbiAgcGxhaW5HYWxsZXJ5Q29uZmlnOiBERUZBVUxUX1BMQUlOX0NPTkZJRyxcbiAgY3VycmVudEltYWdlQ29uZmlnOiBERUZBVUxUX0NVUlJFTlRfSU1BR0VfQ09ORklHLFxuICBrZXlib2FyZENvbmZpZzogdW5kZWZpbmVkLCAvLyBieSBkZWZhdWx0IG5vdGhpbmcsIGJlY2F1c2UgdGhlIGxpYnJhcnkgdXNlcyBkZWZhdWx0IGJ1dHRvbnMgYXV0b21hdGljYWxseVxuICBjYXJvdXNlbENvbmZpZzogREVGQVVMVF9DVVJSRU5UX0NBUk9VU0VMX0NPTkZJRyxcbiAgY2Fyb3VzZWxJbWFnZUNvbmZpZzogREVGQVVMVF9DQVJPVVNFTF9JTUFHRV9DT05GSUcsXG4gIGNhcm91c2VsUHJldmlld3NDb25maWc6IERFRkFVTFRfQ0FST1VTRUxfUFJFVklFV1NfQ09ORklHLFxuICBjYXJvdXNlbFBsYXlDb25maWc6IERFRkFVTFRfQ1VSUkVOVF9DQVJPVVNFTF9QTEFZLFxuICBjYXJvdXNlbERvdHNDb25maWc6IHsgdmlzaWJsZTogdHJ1ZSB9IGFzIERvdHNDb25maWcsXG4gIGNhcm91c2VsU2xpZGVJbmZpbml0ZTogdHJ1ZSxcbiAgZW5hYmxlQ2xvc2VPdXRzaWRlOiB0cnVlXG59KTtcblxuLyoqXG4gKiBTZXJ2aWNlIHRvIGhhbmRsZSBsaWJyYXJ5IGNvbmZpZ3VyYXRpb24gaW4gYSB1bmlxdWUgcGxhY2VcbiAqL1xuQEluamVjdGFibGUoeyBwcm92aWRlZEluOiAncm9vdCcgfSlcbmV4cG9ydCBjbGFzcyBDb25maWdTZXJ2aWNlIHtcbiAgY29uZmlnTWFwOiBNYXA8bnVtYmVyLCBMaWJDb25maWc+ID0gbmV3IE1hcDxudW1iZXIsIExpYkNvbmZpZz4oKTtcblxuICBnZXRDb25maWcoaWQ6IG51bWJlcik6IExpYkNvbmZpZyB8IHVuZGVmaW5lZCB7XG4gICAgdGhpcy5pbml0SWZOb3RFeGlzdHMoaWQpO1xuICAgIHJldHVybiB0aGlzLmNvbmZpZ01hcC5nZXQoaWQpO1xuICB9XG5cbiAgc2V0Q29uZmlnKGlkOiBudW1iZXIsIG9iajogTGliQ29uZmlnIHwgdW5kZWZpbmVkKTogdm9pZCB7XG4gICAgdGhpcy5pbml0SWZOb3RFeGlzdHMoaWQpO1xuICAgIGlmICghb2JqKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKFxuICAgICAgIURFRkFVTFRfQ09ORklHIHx8XG4gICAgICAhREVGQVVMVF9DT05GSUcuc2xpZGVDb25maWcgfHxcbiAgICAgICFERUZBVUxUX0NPTkZJRy5zbGlkZUNvbmZpZy5zaWRlUHJldmlld3MgfHxcbiAgICAgICFERUZBVUxUX0NPTkZJRy5wcmV2aWV3Q29uZmlnIHx8XG4gICAgICAhREVGQVVMVF9DT05GSUcucHJldmlld0NvbmZpZy5zaXplIHx8XG4gICAgICAhREVGQVVMVF9DT05GSUcucHJldmlld0NvbmZpZy5udW1iZXIgfHxcbiAgICAgICFERUZBVUxUX0NPTkZJRy5wbGFpbkdhbGxlcnlDb25maWcgfHxcbiAgICAgICFERUZBVUxUX0NPTkZJRy5jdXJyZW50SW1hZ2VDb25maWcgfHxcbiAgICAgICFERUZBVUxUX0NPTkZJRy5jdXJyZW50SW1hZ2VDb25maWcgfHxcbiAgICAgICFERUZBVUxUX0NPTkZJRy5jdXJyZW50SW1hZ2VDb25maWcuZGVzY3JpcHRpb24gfHxcbiAgICAgICFERUZBVUxUX0NPTkZJRy5jYXJvdXNlbEltYWdlQ29uZmlnIHx8XG4gICAgICAhREVGQVVMVF9DT05GSUcuY2Fyb3VzZWxJbWFnZUNvbmZpZy5kZXNjcmlwdGlvbiB8fFxuICAgICAgIURFRkFVTFRfQ09ORklHLmNhcm91c2VsUHJldmlld3NDb25maWcgfHxcbiAgICAgICFERUZBVUxUX0NPTkZJRy5jYXJvdXNlbFByZXZpZXdzQ29uZmlnLmJyZWFrcG9pbnRzIHx8XG4gICAgICAhREVGQVVMVF9DQVJPVVNFTF9QUkVWSUVXU19DT05GSUcubnVtYmVyXG4gICAgKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludGVybmFsIGxpYnJhcnkgZXJyb3IgLSBERUZBVUxUX0NPTkZJRyBtdXN0IGJlIGZ1bGx5IGluaXRpYWxpemVkISEhJyk7XG4gICAgfVxuXG4gICAgY29uc3QgbmV3Q29uZmlnOiBMaWJDb25maWcgPSBPYmplY3QuYXNzaWduKHt9LCB0aGlzLmNvbmZpZ01hcC5nZXQoaWQpKTtcbiAgICBpZiAob2JqLnNsaWRlQ29uZmlnKSB7XG4gICAgICBsZXQgcGxheUNvbmZpZztcbiAgICAgIGxldCBzaWRlUHJldmlld3M7XG4gICAgICBsZXQgc2l6ZTtcbiAgICAgIGlmIChvYmouc2xpZGVDb25maWcucGxheUNvbmZpZykge1xuICAgICAgICBwbGF5Q29uZmlnID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9DT05GSUcuc2xpZGVDb25maWcucGxheUNvbmZpZywgb2JqLnNsaWRlQ29uZmlnLnBsYXlDb25maWcpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcGxheUNvbmZpZyA9IERFRkFVTFRfQ09ORklHLnNsaWRlQ29uZmlnLnBsYXlDb25maWc7XG4gICAgICB9XG4gICAgICBpZiAob2JqLnNsaWRlQ29uZmlnLnNpZGVQcmV2aWV3cykge1xuICAgICAgICBpZiAob2JqLnNsaWRlQ29uZmlnLnNpZGVQcmV2aWV3cy5zaXplKSB7XG4gICAgICAgICAgc2l6ZSA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfQ09ORklHLnNsaWRlQ29uZmlnLnNpZGVQcmV2aWV3cy5zaXplLCBvYmouc2xpZGVDb25maWcuc2lkZVByZXZpZXdzLnNpemUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHNpemUgPSBERUZBVUxUX0NPTkZJRy5zbGlkZUNvbmZpZy5zaWRlUHJldmlld3Muc2l6ZTtcbiAgICAgICAgfVxuICAgICAgICBzaWRlUHJldmlld3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX0NPTkZJRy5zbGlkZUNvbmZpZy5zaWRlUHJldmlld3MsIG9iai5zbGlkZUNvbmZpZy5zaWRlUHJldmlld3MpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2lkZVByZXZpZXdzID0gREVGQVVMVF9DT05GSUcuc2xpZGVDb25maWcuc2lkZVByZXZpZXdzO1xuICAgICAgICBzaXplID0gREVGQVVMVF9DT05GSUcuc2xpZGVDb25maWcuc2lkZVByZXZpZXdzLnNpemU7XG4gICAgICB9XG4gICAgICBjb25zdCBuZXdTbGlkZUNvbmZpZzogU2xpZGVDb25maWcgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX0NPTkZJRy5zbGlkZUNvbmZpZywgb2JqLnNsaWRlQ29uZmlnKTtcbiAgICAgIG5ld1NsaWRlQ29uZmlnLnBsYXlDb25maWcgPSBwbGF5Q29uZmlnO1xuICAgICAgbmV3U2xpZGVDb25maWcuc2lkZVByZXZpZXdzID0gc2lkZVByZXZpZXdzO1xuICAgICAgbmV3U2xpZGVDb25maWcuc2lkZVByZXZpZXdzLnNpemUgPSBzaXplO1xuICAgICAgbmV3Q29uZmlnLnNsaWRlQ29uZmlnID0gbmV3U2xpZGVDb25maWc7XG4gICAgfVxuICAgIGlmIChvYmouYWNjZXNzaWJpbGl0eUNvbmZpZykge1xuICAgICAgbmV3Q29uZmlnLmFjY2Vzc2liaWxpdHlDb25maWcgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX0NPTkZJRy5hY2Nlc3NpYmlsaXR5Q29uZmlnLCBvYmouYWNjZXNzaWJpbGl0eUNvbmZpZyk7XG4gICAgfVxuICAgIGlmIChvYmoucHJldmlld0NvbmZpZykge1xuICAgICAgbGV0IHNpemU6IFNpemU7XG4gICAgICBsZXQgbnVtOiBudW1iZXI7XG4gICAgICBpZiAob2JqLnByZXZpZXdDb25maWcuc2l6ZSkge1xuICAgICAgICBzaXplID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9DT05GSUcucHJldmlld0NvbmZpZy5zaXplLCBvYmoucHJldmlld0NvbmZpZy5zaXplKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNpemUgPSBERUZBVUxUX0NPTkZJRy5wcmV2aWV3Q29uZmlnLnNpemU7XG4gICAgICB9XG4gICAgICBpZiAob2JqLnByZXZpZXdDb25maWcubnVtYmVyKSB7XG4gICAgICAgIGlmIChvYmoucHJldmlld0NvbmZpZy5udW1iZXIgPD0gMCkge1xuICAgICAgICAgIC8vIGlmIG51bWJlciBpcyA8PSAwIHJlc2V0IHRvIGRlZmF1bHRcbiAgICAgICAgICBudW0gPSBERUZBVUxUX0NPTkZJRy5wcmV2aWV3Q29uZmlnLm51bWJlcjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBudW0gPSBvYmoucHJldmlld0NvbmZpZy5udW1iZXI7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG51bSA9IERFRkFVTFRfQ09ORklHLnByZXZpZXdDb25maWcubnVtYmVyO1xuICAgICAgfVxuICAgICAgY29uc3QgbmV3UHJldmlld0NvbmZpZzogUHJldmlld0NvbmZpZyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfQ09ORklHLnByZXZpZXdDb25maWcsIG9iai5wcmV2aWV3Q29uZmlnKTtcbiAgICAgIG5ld1ByZXZpZXdDb25maWcuc2l6ZSA9IHNpemU7XG4gICAgICBuZXdQcmV2aWV3Q29uZmlnLm51bWJlciA9IG51bTtcbiAgICAgIG5ld0NvbmZpZy5wcmV2aWV3Q29uZmlnID0gbmV3UHJldmlld0NvbmZpZztcbiAgICB9XG4gICAgaWYgKG9iai5idXR0b25zQ29uZmlnKSB7XG4gICAgICBuZXdDb25maWcuYnV0dG9uc0NvbmZpZyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfQ09ORklHLmJ1dHRvbnNDb25maWcsIG9iai5idXR0b25zQ29uZmlnKTtcbiAgICB9XG4gICAgaWYgKG9iai5kb3RzQ29uZmlnKSB7XG4gICAgICBuZXdDb25maWcuZG90c0NvbmZpZyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfQ09ORklHLmRvdHNDb25maWcsIG9iai5kb3RzQ29uZmlnKTtcbiAgICB9XG4gICAgaWYgKG9iai5wbGFpbkdhbGxlcnlDb25maWcpIHtcbiAgICAgIGxldCBhZHZhbmNlZDtcbiAgICAgIGxldCBsYXlvdXQ7XG4gICAgICBpZiAob2JqLnBsYWluR2FsbGVyeUNvbmZpZy5hZHZhbmNlZCkge1xuICAgICAgICBhZHZhbmNlZCA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfQ09ORklHLnBsYWluR2FsbGVyeUNvbmZpZy5hZHZhbmNlZCwgb2JqLnBsYWluR2FsbGVyeUNvbmZpZy5hZHZhbmNlZCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhZHZhbmNlZCA9IERFRkFVTFRfQ09ORklHLnBsYWluR2FsbGVyeUNvbmZpZy5hZHZhbmNlZDtcbiAgICAgIH1cbiAgICAgIGlmIChvYmoucGxhaW5HYWxsZXJ5Q29uZmlnLmxheW91dCkge1xuICAgICAgICAvLyBpdCBpc24ndCBtYW5kYXRvcnkgdG8gdXNlIGFzc2lnbiwgYmVjYXVzZSBvYmoucGxhaW5HYWxsZXJ5Q29uZmlnLmxheW91dCBpcyBhbiBpbnN0YW5jZSBvZiBjbGFzcyAoTGluZWFMYXlvdXQsIEdyaWRMYXlvdXQpXG4gICAgICAgIGxheW91dCA9IG9iai5wbGFpbkdhbGxlcnlDb25maWcubGF5b3V0O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbGF5b3V0ID0gREVGQVVMVF9DT05GSUcucGxhaW5HYWxsZXJ5Q29uZmlnLmxheW91dDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IG5ld1BsYWluR2FsbGVyeUNvbmZpZzogUGxhaW5HYWxsZXJ5Q29uZmlnID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9DT05GSUcucGxhaW5HYWxsZXJ5Q29uZmlnLCBvYmoucGxhaW5HYWxsZXJ5Q29uZmlnKTtcbiAgICAgIG5ld1BsYWluR2FsbGVyeUNvbmZpZy5sYXlvdXQgPSBsYXlvdXQ7XG4gICAgICBuZXdQbGFpbkdhbGxlcnlDb25maWcuYWR2YW5jZWQgPSBhZHZhbmNlZDtcbiAgICAgIG5ld0NvbmZpZy5wbGFpbkdhbGxlcnlDb25maWcgPSBpbml0UGxhaW5HYWxsZXJ5Q29uZmlnKG5ld1BsYWluR2FsbGVyeUNvbmZpZyk7XG4gICAgfVxuICAgIGlmIChvYmouY3VycmVudEltYWdlQ29uZmlnKSB7XG4gICAgICBsZXQgbG9hZGluZztcbiAgICAgIGxldCBkZXNjcmlwdGlvbjtcbiAgICAgIGxldCBkZXNjcmlwdGlvblN0eWxlO1xuICAgICAgaWYgKG9iai5jdXJyZW50SW1hZ2VDb25maWcubG9hZGluZ0NvbmZpZykge1xuICAgICAgICBsb2FkaW5nID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9DT05GSUcuY3VycmVudEltYWdlQ29uZmlnLmxvYWRpbmdDb25maWcsIG9iai5jdXJyZW50SW1hZ2VDb25maWcubG9hZGluZ0NvbmZpZyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBsb2FkaW5nID0gREVGQVVMVF9DT05GSUcuY3VycmVudEltYWdlQ29uZmlnLmxvYWRpbmdDb25maWc7XG4gICAgICB9XG4gICAgICBpZiAob2JqLmN1cnJlbnRJbWFnZUNvbmZpZy5kZXNjcmlwdGlvbikge1xuICAgICAgICBkZXNjcmlwdGlvbiA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfQ09ORklHLmN1cnJlbnRJbWFnZUNvbmZpZy5kZXNjcmlwdGlvbiwgb2JqLmN1cnJlbnRJbWFnZUNvbmZpZy5kZXNjcmlwdGlvbik7XG4gICAgICAgIGlmIChvYmouY3VycmVudEltYWdlQ29uZmlnLmRlc2NyaXB0aW9uLnN0eWxlKSB7XG4gICAgICAgICAgZGVzY3JpcHRpb25TdHlsZSA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfQ09ORklHLmN1cnJlbnRJbWFnZUNvbmZpZy5kZXNjcmlwdGlvbi5zdHlsZSwgb2JqLmN1cnJlbnRJbWFnZUNvbmZpZy5kZXNjcmlwdGlvbi5zdHlsZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZGVzY3JpcHRpb25TdHlsZSA9IERFRkFVTFRfQ09ORklHLmN1cnJlbnRJbWFnZUNvbmZpZy5kZXNjcmlwdGlvbi5zdHlsZTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZGVzY3JpcHRpb24gPSBERUZBVUxUX0NPTkZJRy5jdXJyZW50SW1hZ2VDb25maWcuZGVzY3JpcHRpb247XG4gICAgICAgIGRlc2NyaXB0aW9uU3R5bGUgPSBERUZBVUxUX0NPTkZJRy5jdXJyZW50SW1hZ2VDb25maWcuZGVzY3JpcHRpb24uc3R5bGU7XG4gICAgICB9XG4gICAgICBjb25zdCBuZXdDdXJyZW50SW1hZ2VDb25maWc6IEN1cnJlbnRJbWFnZUNvbmZpZyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfQ09ORklHLmN1cnJlbnRJbWFnZUNvbmZpZywgb2JqLmN1cnJlbnRJbWFnZUNvbmZpZyk7XG4gICAgICBuZXdDdXJyZW50SW1hZ2VDb25maWcubG9hZGluZ0NvbmZpZyA9IGxvYWRpbmc7XG4gICAgICBuZXdDdXJyZW50SW1hZ2VDb25maWcuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcbiAgICAgIG5ld0N1cnJlbnRJbWFnZUNvbmZpZy5kZXNjcmlwdGlvbi5zdHlsZSA9IGRlc2NyaXB0aW9uU3R5bGU7XG4gICAgICBuZXdDb25maWcuY3VycmVudEltYWdlQ29uZmlnID0gbmV3Q3VycmVudEltYWdlQ29uZmlnO1xuICAgIH1cbiAgICBpZiAob2JqLmtleWJvYXJkQ29uZmlnKSB7XG4gICAgICBuZXdDb25maWcua2V5Ym9hcmRDb25maWcgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX0NPTkZJRy5rZXlib2FyZENvbmZpZywgb2JqLmtleWJvYXJkQ29uZmlnKTtcbiAgICB9XG5cbiAgICAvLyBjYXJvdXNlbFxuICAgIGlmIChvYmouY2Fyb3VzZWxDb25maWcpIHtcbiAgICAgIG5ld0NvbmZpZy5jYXJvdXNlbENvbmZpZyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfQ09ORklHLmNhcm91c2VsQ29uZmlnLCBvYmouY2Fyb3VzZWxDb25maWcpO1xuICAgIH1cbiAgICBpZiAob2JqLmNhcm91c2VsSW1hZ2VDb25maWcpIHtcbiAgICAgIGxldCBkZXNjcmlwdGlvbjtcbiAgICAgIGxldCBkZXNjcmlwdGlvblN0eWxlO1xuICAgICAgaWYgKG9iai5jYXJvdXNlbEltYWdlQ29uZmlnLmRlc2NyaXB0aW9uKSB7XG4gICAgICAgIGRlc2NyaXB0aW9uID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9DT05GSUcuY2Fyb3VzZWxJbWFnZUNvbmZpZy5kZXNjcmlwdGlvbiwgb2JqLmNhcm91c2VsSW1hZ2VDb25maWcuZGVzY3JpcHRpb24pO1xuICAgICAgICBpZiAob2JqLmNhcm91c2VsSW1hZ2VDb25maWcuZGVzY3JpcHRpb24uc3R5bGUpIHtcbiAgICAgICAgICBkZXNjcmlwdGlvblN0eWxlID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9DT05GSUcuY2Fyb3VzZWxJbWFnZUNvbmZpZy5kZXNjcmlwdGlvbi5zdHlsZSwgb2JqLmNhcm91c2VsSW1hZ2VDb25maWcuZGVzY3JpcHRpb24uc3R5bGUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGRlc2NyaXB0aW9uU3R5bGUgPSBERUZBVUxUX0NPTkZJRy5jYXJvdXNlbEltYWdlQ29uZmlnLmRlc2NyaXB0aW9uLnN0eWxlO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBkZXNjcmlwdGlvbiA9IERFRkFVTFRfQ09ORklHLmNhcm91c2VsSW1hZ2VDb25maWcuZGVzY3JpcHRpb247XG4gICAgICAgIGRlc2NyaXB0aW9uU3R5bGUgPSBERUZBVUxUX0NPTkZJRy5jYXJvdXNlbEltYWdlQ29uZmlnLmRlc2NyaXB0aW9uLnN0eWxlO1xuICAgICAgfVxuICAgICAgY29uc3QgbmV3Q2Fyb3VzZWxJbWFnZUNvbmZpZzogQ2Fyb3VzZWxJbWFnZUNvbmZpZyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfQ09ORklHLmNhcm91c2VsSW1hZ2VDb25maWcsIG9iai5jYXJvdXNlbEltYWdlQ29uZmlnKTtcbiAgICAgIG5ld0Nhcm91c2VsSW1hZ2VDb25maWcuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcbiAgICAgIG5ld0Nhcm91c2VsSW1hZ2VDb25maWcuZGVzY3JpcHRpb24uc3R5bGUgPSBkZXNjcmlwdGlvblN0eWxlO1xuICAgICAgbmV3Q29uZmlnLmNhcm91c2VsSW1hZ2VDb25maWcgPSBuZXdDYXJvdXNlbEltYWdlQ29uZmlnO1xuICAgIH1cbiAgICBpZiAob2JqLmNhcm91c2VsUGxheUNvbmZpZykge1xuICAgICAgLy8gY2hlY2sgdmFsdWVzXG4gICAgICBpZiAob2JqLmNhcm91c2VsUGxheUNvbmZpZy5pbnRlcnZhbCA8PSAwKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgQ2Fyb3VzZWwncyBpbnRlcnZhbCBtdXN0IGJlIGEgbnVtYmVyID49IDBgKTtcbiAgICAgIH1cbiAgICAgIG5ld0NvbmZpZy5jYXJvdXNlbFBsYXlDb25maWcgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX0NPTkZJRy5jYXJvdXNlbFBsYXlDb25maWcsIG9iai5jYXJvdXNlbFBsYXlDb25maWcpO1xuICAgIH1cbiAgICBpZiAob2JqLmNhcm91c2VsUHJldmlld3NDb25maWcpIHtcbiAgICAgIC8vIGNoZWNrIHZhbHVlc1xuICAgICAgbGV0IG51bTogbnVtYmVyO1xuICAgICAgbGV0IGJyZWFrcG9pbnRzOiBCcmVha3BvaW50c0NvbmZpZztcbiAgICAgIGlmICghb2JqLmNhcm91c2VsUHJldmlld3NDb25maWcubnVtYmVyIHx8IG9iai5jYXJvdXNlbFByZXZpZXdzQ29uZmlnLm51bWJlciA8PSAwKSB7XG4gICAgICAgIG51bSA9IERFRkFVTFRfQ0FST1VTRUxfUFJFVklFV1NfQ09ORklHLm51bWJlcjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG51bSA9IG9iai5jYXJvdXNlbFByZXZpZXdzQ29uZmlnLm51bWJlcjtcbiAgICAgIH1cbiAgICAgIGlmIChvYmouY2Fyb3VzZWxQcmV2aWV3c0NvbmZpZy5icmVha3BvaW50cykge1xuICAgICAgICBicmVha3BvaW50cyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfQ09ORklHLmNhcm91c2VsUHJldmlld3NDb25maWcuYnJlYWtwb2ludHMsIG9iai5jYXJvdXNlbFByZXZpZXdzQ29uZmlnLmJyZWFrcG9pbnRzKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGJyZWFrcG9pbnRzID0gREVGQVVMVF9DT05GSUcuY2Fyb3VzZWxQcmV2aWV3c0NvbmZpZy5icmVha3BvaW50cztcbiAgICAgIH1cbiAgICAgIG5ld0NvbmZpZy5jYXJvdXNlbFByZXZpZXdzQ29uZmlnID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9DT05GSUcuY2Fyb3VzZWxQcmV2aWV3c0NvbmZpZywgb2JqLmNhcm91c2VsUHJldmlld3NDb25maWcpO1xuICAgICAgbmV3Q29uZmlnLmNhcm91c2VsUHJldmlld3NDb25maWcubnVtYmVyID0gbnVtO1xuICAgICAgbmV3Q29uZmlnLmNhcm91c2VsUHJldmlld3NDb25maWcuYnJlYWtwb2ludHMgPSBicmVha3BvaW50cztcbiAgICAgIC8vIEluaXQgcHJldmlldyBpbWFnZSB3aWR0aCBiYXNlZCBvbiB0aGUgbnVtYmVyIG9mIHByZXZpZXdzIGluIFByZXZpZXdDb25maWdcbiAgICAgIC8vIERvbid0IG1vdmUgdGhpcyBsaW5lIGFib3ZlLCBiZWNhdXNlIEkgbmVlZCB0byBiZSBzdXJlIHRoYXQgYm90aCBjb25maWdQcmV2aWV3Lm51bWJlclxuICAgICAgLy8gYW5kIGNvbmZpZ1ByZXZpZXcuc2l6ZSBhcmUgaW5pdGlhbGl6ZWRcbiAgICAgIG5ld0NvbmZpZy5jYXJvdXNlbFByZXZpZXdzQ29uZmlnLndpZHRoID0gMTAwIC8gbmV3Q29uZmlnLmNhcm91c2VsUHJldmlld3NDb25maWcubnVtYmVyICsgJyUnO1xuICAgIH1cbiAgICBpZiAob2JqLmNhcm91c2VsRG90c0NvbmZpZykge1xuICAgICAgbmV3Q29uZmlnLmNhcm91c2VsRG90c0NvbmZpZyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfQ09ORklHLmNhcm91c2VsRG90c0NvbmZpZywgb2JqLmNhcm91c2VsRG90c0NvbmZpZyk7XG4gICAgfVxuICAgIGlmIChvYmouY2Fyb3VzZWxTbGlkZUluZmluaXRlID09PSB1bmRlZmluZWQpIHtcbiAgICAgIG5ld0NvbmZpZy5jYXJvdXNlbFNsaWRlSW5maW5pdGUgPSBERUZBVUxUX0NPTkZJRy5jYXJvdXNlbFNsaWRlSW5maW5pdGU7XG4gICAgfSBlbHNlIHtcbiAgICAgIG5ld0NvbmZpZy5jYXJvdXNlbFNsaWRlSW5maW5pdGUgPSBvYmouY2Fyb3VzZWxTbGlkZUluZmluaXRlO1xuICAgIH1cbiAgICBpZiAob2JqLmVuYWJsZUNsb3NlT3V0c2lkZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBuZXdDb25maWcuZW5hYmxlQ2xvc2VPdXRzaWRlID0gREVGQVVMVF9DT05GSUcuZW5hYmxlQ2xvc2VPdXRzaWRlO1xuICAgIH0gZWxzZSB7XG4gICAgICBuZXdDb25maWcuZW5hYmxlQ2xvc2VPdXRzaWRlID0gb2JqLmVuYWJsZUNsb3NlT3V0c2lkZTtcbiAgICB9XG4gICAgdGhpcy5jb25maWdNYXAuc2V0KGlkLCBuZXdDb25maWcpO1xuICB9XG5cbiAgcHJpdmF0ZSBpbml0SWZOb3RFeGlzdHMoaWQ6IG51bWJlcik6IHZvaWQge1xuICAgIGlmICghdGhpcy5jb25maWdNYXAuaGFzKGlkKSkge1xuICAgICAgdGhpcy5jb25maWdNYXAuc2V0KGlkLCBERUZBVUxUX0NPTkZJRyk7XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICogRnVuY3Rpb24gdG8gYnVpbGQgYW5kIHJldHVybiBhIGBQbGFpbkdhbGxlcnlDb25maWdgIG9iamVjdCwgcHJvdmluZyBhbHNvIGRlZmF1bHQgdmFsdWVzIGFuZCB2YWxpZGF0aW5nIHRoZSBpbnB1dCBvYmplY3QuXG4gKiBAcGFyYW0gcGxhaW5HYWxsZXJ5Q29uZmlnIG9iamVjdCB3aXRoIHRoZSBjb25maWcgcmVxdWVzdGVkIGJ5IHVzZXJcbiAqIEByZXR1cm5zIFBsYWluR2FsbGVyeUNvbmZpZyB0aGUgcGxhaW4gZ2FsbGVyeSBjb25maWd1cmF0aW9uXG4gKiBAdGhyb3dzIGFuIEVycm9yIGlmIGxheW91dCBhbmQgc3RyYXRlZ3kgYXJlbid0IGNvbXBhdGlibGVcbiAqL1xuZnVuY3Rpb24gaW5pdFBsYWluR2FsbGVyeUNvbmZpZyhwbGFpbkdhbGxlcnlDb25maWc6IFBsYWluR2FsbGVyeUNvbmZpZyk6IFBsYWluR2FsbGVyeUNvbmZpZyB7XG4gIGNvbnN0IG5ld1BsYXlHYWxsZXJ5Q29uZmlnOiBQbGFpbkdhbGxlcnlDb25maWcgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX0NPTkZJRy5wbGFpbkdhbGxlcnlDb25maWcsIHBsYWluR2FsbGVyeUNvbmZpZyk7XG5cbiAgaWYgKG5ld1BsYXlHYWxsZXJ5Q29uZmlnLmxheW91dCBpbnN0YW5jZW9mIExpbmVMYXlvdXQpIHtcbiAgICBpZiAobmV3UGxheUdhbGxlcnlDb25maWcuc3RyYXRlZ3kgIT09IFBsYWluR2FsbGVyeVN0cmF0ZWd5LlJPVyAmJiBuZXdQbGF5R2FsbGVyeUNvbmZpZy5zdHJhdGVneSAhPT0gUGxhaW5HYWxsZXJ5U3RyYXRlZ3kuQ09MVU1OKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0xpbmVMYXlvdXQgcmVxdWlyZXMgZWl0aGVyIFJPVyBvciBDT0xVTU4gc3RyYXRlZ3knKTtcbiAgICB9XG4gICAgaWYgKCFuZXdQbGF5R2FsbGVyeUNvbmZpZy5sYXlvdXQgfHwgIW5ld1BsYXlHYWxsZXJ5Q29uZmlnLmxheW91dC5icmVha0NvbmZpZykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdCb3RoIGxheW91dCBhbmQgYnJlYWtDb25maWcgbXVzdCBiZSB2YWxpZCcpO1xuICAgIH1cbiAgfVxuXG4gIGlmIChuZXdQbGF5R2FsbGVyeUNvbmZpZy5sYXlvdXQgaW5zdGFuY2VvZiBHcmlkTGF5b3V0KSB7XG4gICAgaWYgKG5ld1BsYXlHYWxsZXJ5Q29uZmlnLnN0cmF0ZWd5ICE9PSBQbGFpbkdhbGxlcnlTdHJhdGVneS5HUklEKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0dyaWRMYXlvdXQgcmVxdWlyZXMgR1JJRCBzdHJhdGVneScpO1xuICAgIH1cbiAgICBpZiAoIW5ld1BsYXlHYWxsZXJ5Q29uZmlnLmxheW91dCB8fCAhbmV3UGxheUdhbGxlcnlDb25maWcubGF5b3V0LmJyZWFrQ29uZmlnKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0JvdGggbGF5b3V0IGFuZCBicmVha0NvbmZpZyBtdXN0IGJlIHZhbGlkJyk7XG4gICAgfVxuICAgIC8vIGZvcmNlIHdyYXAgZm9yIGdyaWQgbGF5b3V0XG4gICAgbmV3UGxheUdhbGxlcnlDb25maWcubGF5b3V0LmJyZWFrQ29uZmlnLndyYXAgPSB0cnVlO1xuICB9XG4gIHJldHVybiBuZXdQbGF5R2FsbGVyeUNvbmZpZztcbn1cbiJdfQ==